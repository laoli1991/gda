<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用户管理</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="./css/x-admin.css" media="all">
    <link rel="stylesheet" href="css/pag.css" media="all">
    <link rel="stylesheet" type="text/css" href="./lib/bootstrap/css/bootstrap.css">

</head>
<body>
<div class="x-nav"><span class="layui-breadcrumb"> <a><cite>档案管理</cite></a> <a><cite>档案查询</cite></a> </span></div>
<div class="dangan-x-body" ng-app="dafind" ng-controller="dafindCtrl">
    <div class="">
        <div class="col-sm-8">
            <div>
                <div class="row">
                    <label class="col-sm-4 control-label">姓名</label>
                    <input type="text" class="col-sm-8 control-label" ng-model="teacherQuery.name">
                </div>
                <div class="row">
                    <label class="col-sm-4 control-label">教师编号</label>
                    <input type="text" class="col-sm-8 control-label" ng-model="teacherQuery.teacherNo">
                </div>
                <div class="row">
                    <label class="col-sm-4 control-label">身份证号</label>
                    <input type="text" class="col-sm-8 control-label" ng-model="teacherQuery.identityNO">
                </div>
            </div>
        </div>
        <div class="col-sm-4">
            <div>
                <div class="row">
                    <br>
                </div>
                <div class="text-center">
                    <button class="layui-btn" ng-click="findTeachers(teacherQuery,1)">
                        查询
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="tools">

    </div>
    <table class="tablelist">
        <thead>
        <tr>
            <th>姓名</th>
            <th>身份证</th>
            <th>编号</th>
            <th>详情</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="teacher in teachers">
            <td> {{teacher.name}}</td>
            <td> {{teacher.identityNO}}</td>
            <td> {{teacher.teacherNo}}</td>
            <td>
                <li ng-click="userInfo('档案详情','Dangan-look.html','1000','600', teacher)">
                    <span><img src="images/t06.png"/></span>
                </li>
            </td>
        </tr>

        </tbody>
    </table>
    <div class="page" v-show="show">
        <div class="pagelist">
            <span class="jump" ng-click="findOffPageTeachers(teacherQuery, -1)">上一页</span>
            <span class="ellipsis">(第{{pageNum}}页)</span>
            <span class="jump" ng-click="findOffPageTeachers(teacherQuery, 1)">下一页</span>
            <span class="x-right">&nbsp;&nbsp;共有{{totalCount}}条数据</span></xblock>
        </div>
    </div>
    <br/>
    <br/>
    <br/>
    <script src="./lib/layui/layui.js" charset="utf-8"></script>
    <script src="./js/x-layui.js" charset="utf-8"></script>
    <script src="js/jquery2.js" charset="utf-8"></script>
    <script src="js/js.js" charset="utf-8"></script>
    <script src="js/angular.js" charset="utf-8"></script>
    <script>


        var app = angular.module('dafind', []);
        app.controller('dafindCtrl', ["$scope", '$http', '$q', function ($scope, $http, $q) {

            $('.tablelist tbody tr:odd').addClass('odd');

            layui.use(['laydate', 'element', 'laypage', 'layer'], function () {
                $ = layui.jquery;
                lement = layui.element();//面包导航
                laypage = layui.laypage;//分页
                layer = layui.layer;//弹出层

            });

            /*用户-添加*/
            function user_management_add(title, url, w, h) {
                x_admin_show(title, url, w, h);
            }

            /*用户-查看*/
            $scope.userInfo = function(title, url, w, h,teacher) {
                console.log("sdsdsd")
                show_userInfo(title, url, w, h,teacher.id);
            }

            // 用户-编辑
            function user_management_edit(title, url, w, h) {
                x_admin_show(title, url, w, h);
            }

            $scope.findTeachers = function (teacherQuery, pageNO) {
                if (teacherQuery == undefined) {
                    teacherQuery = {};
                }
                layer.load(1, {shade: false});
                $scope.addTeachering = true;
                $http({
                    method: 'post',
                    url: '../api/find-teachers',
                    data: {
                        "name": teacherQuery.name,
                        "identityNO": teacherQuery.identityNO,
                        "teacherNo": teacherQuery.teacherNo,
                        "pageNO": pageNO
                    }
                }).then(function (req) {
                    layer.closeAll("loading");
                    $scope.addTeachering = false;
                    $scope.teachers = req.data.teacherVos;
                    $scope.teachers = req.data.teacherVos;
                    $scope.totalCount = req.data.totalCount;
                    $scope.pageNum = req.data.pageNum;
                    $scope.totalPages = req.data.totalPages;
                })
            };

            $http({
                method: 'post',
                url: '../api/find-teachers',
                data: {
                    "name": null,
                    "identityNO": null,
                    "teacherNo": null,
                    "pageNO": 1
                }
            }).then(function (req) {
                $scope.addTeachering = false;
                $scope.teachers = req.data.teacherVos;
                $scope.teachers = req.data.teacherVos;
                $scope.totalCount = req.data.totalCount;
                $scope.pageNum = req.data.pageNum;
                $scope.totalPages = req.data.totalPages;
            });


            $scope.findOffPageTeachers = function (teacherQuery, off) {
                pageNO = $scope.pageNum + off;
                if (pageNO < 1 || pageNO > $scope.totalPages) {
                    return;
                }
                $scope.findTeachers(teacherQuery, pageNO);
            };

        }]);

    </script>
    <script type="text/javascript">
        $('.tablelist tbody tr:odd').addClass('odd');
    </script>
</body>
</html>